
# 操作说明


- [操作说明](#操作说明)
  - [运行环境](#运行环境)
  - [运行程序前的准备工作](#运行程序前的准备工作)
    - [数据准备](#数据准备)
    - [数据说明](#数据说明)
      - [级别规范：](#级别规范)
  - [程序运行](#程序运行)
  - [程序执行](#程序执行)
  - [控制台输出](#控制台输出)
  - [输出文件](#输出文件)
    - [“各部门绩效” 文件夹](#各部门绩效-文件夹)
    - [各分支行得分情况表.xlsx](#各分支行得分情况表xlsx)



## 运行环境

1. 操作系统：Windows 7及以上
2. Excel版本 2007以上（仅支持xlsx）
3. VC14运行库
## 运行程序前的准备工作

### 数据准备
将所需数据放在main.exe同目录下
- task1.xlsx：需要拆分的数据表
- task2.xlsx：KPI源数据
- rule.xlsx： KPI计算规则

### 数据说明
1. >task1.xlsx:  需要拆分的数据表  
请注意，一个sheet中只能有一个表，请手动拆分以满足要求  
例如：  
    第二张sheet**四季度清算绩效（管理人员）** 有两个表格，请手动将其拆分  
    两个新sheet分别为 **各岗位管理人员绩效工资明细表（负责人、营销主管）**、**营运主管绩效工资明细表**

2. >task2.xlsx：KPI源数据  
请确保KPI源数据格式与示例完全一致，做到每列都能对应
标准的数据区域是 A12:NG23，列范围不可随意修改


3. >rule.xlsx： KPI计算规则  
默认即可，如需修改请注意：  
级别需要做到统一且规范,如下所示  

#### 级别规范： 
>总分  
大项指标：['经营效益','发展转型','风险合规','社会责任']  
1.xxx  
1.1xxx  
1.1.1xxx  
(1)xxx 括号可能是中文括号，也可能是英文括号  
a.xxx  
(2)xxx  

e.g.
||
|-|
| 3.2住房租赁             |
| 3.2.1转化客户数          |
| 3.2.2推荐给建信住房并签约的项目数 |
| 3.2.3保障性租赁住房支持      |
| 3.2.4合规协同           |
| 债转股                 |

> 没有序号的，自动归为临近上一级的子项  
“**债转股**”是“**3.2住房租赁**”的子项  
但是程序只能将其归为“**3.2.4合规协同**”的子项


## 程序运行

1. 数据准备完成后，点击[main](./main.exe)运行程序 
2. 根据程序提示输入指令并按Enter即可执行对应命令

## 程序执行

1. 运行过程中程序不可被打断，若打断，需在任务管理器中手动关闭所有excel进程。

## 控制台输出

执行过程中，程序会输出提示信息，并在同目录下生成文件  
1. 执行拆表过程的输出
> -正在处理： 综合管理部 .xlsx----------------
> 
| 表序号 |  部门名  |     表名               |     有效行号          |
|------------------------------------|-------|-----------------------|------------------|
| 0                                  | 综合管理部 | 四季度清算绩效（部门）           | [5, 4]           |
| 1                                  | 综合管理部 | 四季度清算绩效（营运主管）         | [4]              |
| 2                                  | 综合管理部 | 四季度清算绩效（负责人、营销主管）     | [6, 5]           |
| 3                                  | 综合管理部 | 绩效工资拨付明细表             | [5, 4]           |
| 4                                  | 综合管理部 | 各岗位管理人员绩效工资（负责人、营销主管） | [6, 5]           |
| 5                                  | 综合管理部 | 各岗位管理人员绩效工资（营运主管）     | [4]              |
| 6                                  | 综合管理部 | 专业技术人员绩效(含助理)         | [6, 5, 4, 3]     |
| 7                                  | 综合管理部 | 行长奖励基金（部门）            | [2, 1]           |
| 8                                  | 综合管理部 | 考核挂钩系数                | [40, 39, 38, 3]  |
| 9                                  | 综合管理部 | 对公业务绩效                | [43, 3]          |
| 10                                 | 综合管理部 | 个人及信用卡业务绩效            | [5]              |
| 11                                 | 综合管理部 | 对公结算业务绩效              | [4]              |
| 12                                 | 综合管理部 | 住房金融业务绩效              | [3]              |
| 13                                 | 综合管理部 | 公积金业务绩效               | [2]              |
| 14                                 | 综合管理部 | 普惠贷款风险金               | [3]              |
| 15                                 | 综合管理部 | 计奖人数表                 | [5, 4]           |
| 16                                 | 综合管理部 | 借调人员                  | [2]              |

注：有效行号除了最后一个数字，其它都是需要摘出来的行号，最后一个数字是表头信息的最后一行行号

## 输出文件
###  “各部门绩效” 文件夹

>按部门命名的、拆分后的绩效表  
格式与sheets和data1.xlsx保持一致

### 各分支行得分情况表.xlsx
>计算的得分文件  
得分按照指标名排列  
表头是各分支行得分和排名  
大类指标间用空行隔开